/*
 * FilePondPluginFileEncode 2.0.0
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */
const DataURIWorker=function(){self.onmessage=(a=>{e(a.data.message,e=>{self.postMessage({id:a.data.id,message:e})})});const e=(e,a)=>{const{file:t}=e,i=new FileReader;i.onloadend=(()=>{a(i.result.replace("data:","").replace(/^.+,/,""))}),i.readAsDataURL(t)}};var plugin$1=({addFilter:e,utils:a})=>{const{Type:t,createWorker:i,createRoute:d,isFile:n}=a,o=[];return e("SHOULD_PREPARE_OUTPUT",()=>new Promise(e=>{e(!0)})),e("COMPLETE_PREPARE_OUTPUT",(e,{item:a})=>new Promise(t=>{if(!n(e))return void t(e);o[a.id]={metadata:a.getMetadata(),imagedata:null};i(DataURIWorker).post({file:e},i=>{o[a.id].imagedata=i,t(e)})})),e("CREATE_VIEW",e=>{const{is:a,view:t,query:i}=e;a("file-wrapper")&&i("GET_ALLOW_FILE_ENCODE")&&t.registerWriter(d({DID_PREPARE_OUTPUT:({root:e,action:a})=>{if(i("IS_ASYNC"))return;const t=i("GET_ITEM",a.id),d=o[t.id],n=d.metadata,r=d.imagedata;e.ref.data.value=JSON.stringify({id:t.id,name:t.file.name,type:t.file.type,size:t.file.size,metadata:n,data:r}),o[t.id].imagedata=null}}))}),{options:{allowFileEncode:[!0,t.BOOLEAN]}}};const isBrowser="undefined"!=typeof window&&void 0!==window.document;isBrowser&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin$1}));export default plugin$1;